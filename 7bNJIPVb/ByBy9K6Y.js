import{A as AstroError,g as NoImageMetadata,F as FailedToFetchRemoteImageDimensions,E as ExpectedImageOptions,h as ExpectedImage,j as ExpectedNotESMImage,k as resolveSrc,l as isRemoteImage,i as isRemotePath,m as isESMImportedImage,n as isLocalService,D as DEFAULT_HASH_PROPS,o as InvalidImageService,q as ImageMissingAlt}from"./DEWHgkAV.js";import{d as createAstro,c as createComponent,r as renderTemplate,m as maybeRenderHead,b as addAttribute,s as spreadAttributes}from"./4CUkstck.js";import*as mime from"mrmime";import"clsx";function isImageMetadata(t){return t.fsPath&&!("fsPath"in t)}const decoder=new TextDecoder,toUTF8String=(t,e=0,r=t.length)=>decoder.decode(t.slice(e,r)),toHexString=(t,e=0,r=t.length)=>t.slice(e,r).reduce(((t,e)=>t+("0"+e.toString(16)).slice(-2)),""),readInt16LE=(t,e=0)=>{const r=t[e]+256*t[e+1];return r|131070*(32768&r)},readUInt16BE=(t,e=0)=>256*t[e]+t[e+1],readUInt16LE=(t,e=0)=>t[e]+256*t[e+1],readUInt24LE=(t,e=0)=>t[e]+256*t[e+1]+65536*t[e+2],readInt32LE=(t,e=0)=>t[e]+256*t[e+1]+65536*t[e+2]+(t[e+3]<<24),readUInt32BE=(t,e=0)=>t[e]*2**24+65536*t[e+1]+256*t[e+2]+t[e+3],readUInt32LE=(t,e=0)=>t[e]+256*t[e+1]+65536*t[e+2]+t[e+3]*2**24,methods={readUInt16BE:readUInt16BE,readUInt16LE:readUInt16LE,readUInt32BE:readUInt32BE,readUInt32LE:readUInt32LE};function readUInt(t,e,r,i){r=r||0;return methods["readUInt"+e+(i?"BE":"LE")](t,r)}function readBox(t,e){if(t.length-e<4)return;const r=readUInt32BE(t,e);return t.length-e<r?void 0:{name:toUTF8String(t,4+e,8+e),offset:e,size:r}}function findBox(t,e,r){for(;r<t.length;){const i=readBox(t,r);if(!i)break;if(i.name===e)return i;r+=i.size}}const BMP={validate:t=>"BM"===toUTF8String(t,0,2),calculate:t=>({height:Math.abs(readInt32LE(t,22)),width:readUInt32LE(t,18)})},TYPE_ICON=1,SIZE_HEADER$1=6,SIZE_IMAGE_ENTRY=16;function getSizeFromOffset(t,e){const r=t[e];return 0===r?256:r}function getImageSize$1(t,e){const r=6+16*e;return{height:getSizeFromOffset(t,r+1),width:getSizeFromOffset(t,r)}}const ICO={validate(t){const e=readUInt16LE(t,0),r=readUInt16LE(t,4);if(0!==e||0===r)return!1;return 1===readUInt16LE(t,2)},calculate(t){const e=readUInt16LE(t,4),r=getImageSize$1(t,0);if(1===e)return r;const i=[r];for(let r=1;r<e;r+=1)i.push(getImageSize$1(t,r));return{height:r.height,images:i,width:r.width}}},TYPE_CURSOR=2,CUR={validate(t){const e=readUInt16LE(t,0),r=readUInt16LE(t,4);if(0!==e||0===r)return!1;return 2===readUInt16LE(t,2)},calculate:t=>ICO.calculate(t)},DDS={validate:t=>542327876===readUInt32LE(t,0),calculate:t=>({height:readUInt32LE(t,12),width:readUInt32LE(t,16)})},gifRegexp=/^GIF8[79]a/,GIF={validate:t=>gifRegexp.test(toUTF8String(t,0,6)),calculate:t=>({height:readUInt16LE(t,8),width:readUInt16LE(t,6)})},brandMap={avif:"avif",mif1:"heif",msf1:"heif",heic:"heic",heix:"heic",hevc:"heic",hevx:"heic"};function detectBrands(t,e,r){let i={};for(let a=e;a<=r;a+=4){const e=toUTF8String(t,a,a+4);e in brandMap&&(i[e]=1)}return"avif"in i?"avif":"heic"in i||"heix"in i||"hevc"in i||"hevx"in i?"heic":"mif1"in i||"msf1"in i?"heif":void 0}const HEIF={validate(t){const e=toUTF8String(t,4,8),r=toUTF8String(t,8,12);return"ftyp"===e&&r in brandMap},calculate(t){const e=findBox(t,"meta",0),r=e&&findBox(t,"iprp",e.offset+12),i=r&&findBox(t,"ipco",r.offset+8),a=i&&findBox(t,"ispe",i.offset+8);if(a)return{height:readUInt32BE(t,a.offset+16),width:readUInt32BE(t,a.offset+12),type:detectBrands(t,8,e.offset)};throw new TypeError("Invalid HEIF, no size found")}},SIZE_HEADER=8,FILE_LENGTH_OFFSET=4,ENTRY_LENGTH_OFFSET=4,ICON_TYPE_SIZE={ICON:32,"ICN#":32,"icm#":16,icm4:16,icm8:16,"ics#":16,ics4:16,ics8:16,is32:16,s8mk:16,icp4:16,icl4:32,icl8:32,il32:32,l8mk:32,icp5:32,ic11:32,ich4:48,ich8:48,ih32:48,h8mk:48,icp6:64,ic12:32,it32:128,t8mk:128,ic07:128,ic08:256,ic13:256,ic09:512,ic14:512,ic10:1024};function readImageHeader(t,e){const r=e+4;return[toUTF8String(t,e,r),readUInt32BE(t,r)]}function getImageSize(t){const e=ICON_TYPE_SIZE[t];return{width:e,height:e,type:t}}const ICNS={validate:t=>"icns"===toUTF8String(t,0,4),calculate(t){const e=t.length,r=readUInt32BE(t,4);let i=8,a=readImageHeader(t,i),n=getImageSize(a[0]);if(i+=a[1],i===r)return n;const s={height:n.height,images:[n],width:n.width};for(;i<r&&i<e;)a=readImageHeader(t,i),n=getImageSize(a[0]),i+=a[1],s.images.push(n);return s}},J2C={validate:t=>"ff4fff51"===toHexString(t,0,4),calculate:t=>({height:readUInt32BE(t,12),width:readUInt32BE(t,8)})},JP2={validate(t){if(1783636e3!==readUInt32BE(t,4)||readUInt32BE(t,0)<1)return!1;const e=findBox(t,"ftyp",0);return!!e&&1718909296===readUInt32BE(t,e.offset+4)},calculate(t){const e=findBox(t,"jp2h",0),r=e&&findBox(t,"ihdr",e.offset+8);if(r)return{height:readUInt32BE(t,r.offset+8),width:readUInt32BE(t,r.offset+12)};throw new TypeError("Unsupported JPEG 2000 format")}},EXIF_MARKER="45786966",APP1_DATA_SIZE_BYTES=2,EXIF_HEADER_BYTES=6,TIFF_BYTE_ALIGN_BYTES=2,BIG_ENDIAN_BYTE_ALIGN="4d4d",LITTLE_ENDIAN_BYTE_ALIGN="4949",IDF_ENTRY_BYTES=12,NUM_DIRECTORY_ENTRIES_BYTES=2;function isEXIF(t){return"45786966"===toHexString(t,2,6)}function extractSize(t,e){return{height:readUInt16BE(t,e),width:readUInt16BE(t,e+2)}}function extractOrientation(t,e){const r=EXIF_HEADER_BYTES+8,i=readUInt(t,16,r,e);for(let a=0;a<i;a++){const i=r+NUM_DIRECTORY_ENTRIES_BYTES+a*IDF_ENTRY_BYTES,n=i+IDF_ENTRY_BYTES;if(i>t.length)return;const s=t.slice(i,n);if(274===readUInt(s,16,0,e)){if(3!==readUInt(s,16,2,e))return;if(1!==readUInt(s,32,4,e))return;return readUInt(s,16,8,e)}}}function validateExifBlock(t,e){const r=t.slice(2,e),i=toHexString(r,EXIF_HEADER_BYTES,EXIF_HEADER_BYTES+2),a="4d4d"===i;if(a||"4949"===i)return extractOrientation(r,a)}function validateInput(t,e){if(e>t.length)throw new TypeError("Corrupt JPG, exceeded buffer limits")}const JPG={validate:t=>"ffd8"===toHexString(t,0,2),calculate(t){let e,r;for(t=t.slice(4);t.length;){const i=readUInt16BE(t,0);if(255===t[i]){if(isEXIF(t)&&(e=validateExifBlock(t,i)),validateInput(t,i),r=t[i+1],192===r||193===r||194===r){const r=extractSize(t,i+5);return e?{height:r.height,orientation:e,width:r.width}:r}t=t.slice(i+2)}else t=t.slice(1)}throw new TypeError("Invalid JPG, no size found")}},KTX={validate:t=>{const e=toUTF8String(t,1,7);return["KTX 11","KTX 20"].includes(e)},calculate:t=>{const e=49===t[5]?"ktx":"ktx2",r="ktx"===e?36:20;return{height:readUInt32LE(t,r+4),width:readUInt32LE(t,r),type:e}}},pngSignature="PNG\r\n\n",pngImageHeaderChunkName="IHDR",pngFriedChunkName="CgBI",PNG={validate(t){if("PNG\r\n\n"===toUTF8String(t,1,8)){let e=toUTF8String(t,12,16);if("CgBI"===e&&(e=toUTF8String(t,28,32)),"IHDR"!==e)throw new TypeError("Invalid PNG");return!0}return!1},calculate:t=>"CgBI"===toUTF8String(t,12,16)?{height:readUInt32BE(t,36),width:readUInt32BE(t,32)}:{height:readUInt32BE(t,20),width:readUInt32BE(t,16)}},PNMTypes={P1:"pbm/ascii",P2:"pgm/ascii",P3:"ppm/ascii",P4:"pbm",P5:"pgm",P6:"ppm",P7:"pam",PF:"pfm"},handlers={default:t=>{let e=[];for(;t.length>0;){const r=t.shift();if("#"!==r[0]){e=r.split(" ");break}}if(2===e.length)return{height:parseInt(e[1],10),width:parseInt(e[0],10)};throw new TypeError("Invalid PNM")},pam:t=>{const e={};for(;t.length>0;){const r=t.shift();if(r.length>16||r.charCodeAt(0)>128)continue;const[i,a]=r.split(" ");if(i&&a&&(e[i.toLowerCase()]=parseInt(a,10)),e.height&&e.width)break}if(e.height&&e.width)return{height:e.height,width:e.width};throw new TypeError("Invalid PAM")}},PNM={validate:t=>toUTF8String(t,0,2)in PNMTypes,calculate(t){const e=toUTF8String(t,0,2),r=PNMTypes[e],i=toUTF8String(t,3).split(/[\r\n]+/);return(handlers[r]||handlers.default)(i)}},PSD={validate:t=>"8BPS"===toUTF8String(t,0,4),calculate:t=>({height:readUInt32BE(t,14),width:readUInt32BE(t,18)})},svgReg=/<svg\s([^>"']|"[^"]*"|'[^']*')*>/,extractorRegExps={height:/\sheight=(['"])([^%]+?)\1/,root:svgReg,viewbox:/\sviewBox=(['"])(.+?)\1/i,width:/\swidth=(['"])([^%]+?)\1/},INCH_CM=2.54,units={in:96,cm:96/2.54,em:16,ex:8,m:96/2.54*100,mm:96/2.54/10,pc:96/72/12,pt:96/72,px:1},unitsReg=new RegExp(`^([0-9.]+(?:e\\d+)?)(${Object.keys(units).join("|")})?$`);function parseLength(t){const e=unitsReg.exec(t);if(e)return Math.round(Number(e[1])*(units[e[2]]||1))}function parseViewbox(t){const e=t.split(" ");return{height:parseLength(e[3]),width:parseLength(e[2])}}function parseAttributes(t){const e=extractorRegExps.width.exec(t),r=extractorRegExps.height.exec(t),i=extractorRegExps.viewbox.exec(t);return{height:r&&parseLength(r[2]),viewbox:i&&parseViewbox(i[2]),width:e&&parseLength(e[2])}}function calculateByDimensions(t){return{height:t.height,width:t.width}}function calculateByViewbox(t,e){const r=e.width/e.height;return t.width?{height:Math.floor(t.width/r),width:t.width}:t.height?{height:t.height,width:Math.floor(t.height*r)}:{height:e.height,width:e.width}}const SVG={validate:t=>svgReg.test(toUTF8String(t,0,1e3)),calculate(t){const e=extractorRegExps.root.exec(toUTF8String(t));if(e){const t=parseAttributes(e[0]);if(t.width&&t.height)return calculateByDimensions(t);if(t.viewbox)return calculateByViewbox(t,t.viewbox)}throw new TypeError("Invalid SVG")}},TGA={validate:t=>0===readUInt16LE(t,0)&&0===readUInt16LE(t,4),calculate:t=>({height:readUInt16LE(t,14),width:readUInt16LE(t,12)})};function readIFD(t,e){const r=readUInt(t,32,4,e);return t.slice(r+2)}function readValue(t,e){const r=readUInt(t,16,8,e);return(readUInt(t,16,10,e)<<16)+r}function nextTag(t){if(t.length>24)return t.slice(12)}function extractTags(t,e){const r={};let i=t;for(;i&&i.length;){const t=readUInt(i,16,0,e),a=readUInt(i,16,2,e),n=readUInt(i,32,4,e);if(0===t)break;1!==n||3!==a&&4!==a||(r[t]=readValue(i,e)),i=nextTag(i)}return r}function determineEndianness(t){const e=toUTF8String(t,0,2);return"II"===e?"LE":"MM"===e?"BE":void 0}const signatures=["49492a00","4d4d002a"],TIFF={validate:t=>signatures.includes(toHexString(t,0,4)),calculate(t){const e="BE"===determineEndianness(t),r=extractTags(readIFD(t,e),e),i=r[256],a=r[257];if(!i||!a)throw new TypeError("Invalid Tiff. Missing tags");return{height:a,width:i}}};function calculateExtended(t){return{height:1+readUInt24LE(t,7),width:1+readUInt24LE(t,4)}}function calculateLossless(t){return{height:1+((15&t[4])<<10|t[3]<<2|(192&t[2])>>6),width:1+((63&t[2])<<8|t[1])}}function calculateLossy(t){return{height:16383&readInt16LE(t,8),width:16383&readInt16LE(t,6)}}const WEBP={validate(t){const e="RIFF"===toUTF8String(t,0,4),r="WEBP"===toUTF8String(t,8,12),i="VP8"===toUTF8String(t,12,15);return e&&r&&i},calculate(t){const e=toUTF8String(t,12,16);if(t=t.slice(20,30),"VP8X"===e){const e=t[0];if(!(192&e)&&!(1&e))return calculateExtended(t);throw new TypeError("Invalid WebP")}if("VP8 "===e&&47!==t[0])return calculateLossy(t);const r=toHexString(t,3,6);if("VP8L"===e&&"9d012a"!==r)return calculateLossless(t);throw new TypeError("Invalid WebP")}},typeHandlers=new Map([["bmp",BMP],["cur",CUR],["dds",DDS],["gif",GIF],["heif",HEIF],["icns",ICNS],["ico",ICO],["j2c",J2C],["jp2",JP2],["jpg",JPG],["ktx",KTX],["png",PNG],["pnm",PNM],["psd",PSD],["svg",SVG],["tga",TGA],["tiff",TIFF],["webp",WEBP]]),types=Array.from(typeHandlers.keys()),firstBytes=new Map([[56,"psd"],[66,"bmp"],[68,"dds"],[71,"gif"],[73,"tiff"],[77,"tiff"],[82,"webp"],[105,"icns"],[137,"png"],[255,"jpg"]]);function detector(t){const e=t[0],r=firstBytes.get(e);return r&&typeHandlers.get(r).validate(t)?r:types.find((e=>typeHandlers.get(e).validate(t)))}const globalOptions={disabledTypes:[]};function lookup(t){const e=detector(t);if(void 0!==e){if(globalOptions.disabledTypes.includes(e))throw new TypeError("disabled file type: "+e);const r=typeHandlers.get(e).calculate(t);if(void 0!==r)return r.type=r.type??e,r}throw new TypeError("unsupported file type: "+e)}async function imageMetadata(t,e){try{const r=lookup(t);if(!r.height||!r.width||!r.type)throw new AstroError({...NoImageMetadata,message:NoImageMetadata.message(e)});const{width:i,height:a,type:n,orientation:s}=r,o=(s||0)>=5;return{width:o?a:i,height:o?i:a,format:n,orientation:s}}catch{throw new AstroError({...NoImageMetadata,message:NoImageMetadata.message(e)})}}async function inferRemoteSize(t){const e=await fetch(t);if(!e.body||!e.ok)throw new AstroError({...FailedToFetchRemoteImageDimensions,message:FailedToFetchRemoteImageDimensions.message(t)});const r=e.body.getReader();let i,a,n=new Uint8Array;for(;!i;){const e=await r.read();if(i=e.done,i)break;if(e.value){a=e.value;let i=new Uint8Array(n.length+a.length);i.set(n,0),i.set(a,n.length),n=i;try{const e=await imageMetadata(n,t);if(e)return await r.cancel(),e}catch{}}}throw new AstroError({...NoImageMetadata,message:NoImageMetadata.message(t)})}async function getConfiguredImageService(){if(!globalThis?.astroAsset?.imageService){const{default:t}=await import("./DEWHgkAV.js").then((t=>t.s)).catch((t=>{const e=new AstroError(InvalidImageService);throw e.cause=t,e}));return globalThis.astroAsset||(globalThis.astroAsset={}),globalThis.astroAsset.imageService=t,t}return globalThis.astroAsset.imageService}async function getImage$1(t,e){if(!t||"object"!=typeof t)throw new AstroError({...ExpectedImageOptions,message:ExpectedImageOptions.message(JSON.stringify(t))});if(void 0===t.src)throw new AstroError({...ExpectedImage,message:ExpectedImage.message(t.src,"undefined",JSON.stringify(t))});if(isImageMetadata(t))throw new AstroError(ExpectedNotESMImage);const r=await getConfiguredImageService(),i={...t,src:await resolveSrc(t.src)};if(t.inferSize&&isRemoteImage(i.src)&&isRemotePath(i.src)){const t=await inferRemoteSize(i.src);i.width??=t.width,i.height??=t.height,delete i.inferSize}const a=isESMImportedImage(i.src)?i.src.fsPath:void 0,n=isESMImportedImage(i.src)?i.src.clone??i.src:i.src;i.src=n;const s=r.validateOptions?await r.validateOptions(i,e):i,o=r.getSrcSet?await r.getSrcSet(s,e):[];let c=await r.getURL(s,e),d=await Promise.all(o.map((async t=>({transform:t.transform,url:await r.getURL(t.transform,e),descriptor:t.descriptor,attributes:t.attributes}))));if(isLocalService(r)&&globalThis.astroAsset.addStaticImage&&(!isRemoteImage(s.src)||c!==s.src)){const t=r.propertiesToHash??DEFAULT_HASH_PROPS;c=globalThis.astroAsset.addStaticImage(s,t,a),d=o.map((e=>({transform:e.transform,url:globalThis.astroAsset.addStaticImage(e.transform,t,a),descriptor:e.descriptor,attributes:e.attributes})))}return{rawOptions:i,options:s,src:c,srcSet:{values:d,attribute:d.map((t=>`${t.url} ${t.descriptor}`)).join(", ")},attributes:void 0!==r.getHTMLAttributes?await r.getHTMLAttributes(s,e):{}}}const $$Astro$1=createAstro("https://tinhmenhdo.com"),$$Image=createComponent((async(t,e,r)=>{const i=t.createAstro($$Astro$1,e,r);i.self=$$Image;const a=i.props;if(void 0===a.alt||null===a.alt)throw new AstroError(ImageMissingAlt);"string"==typeof a.width&&(a.width=parseInt(a.width)),"string"==typeof a.height&&(a.height=parseInt(a.height));const n=await getImage(a),s={};return n.srcSet.values.length>0&&(s.srcset=n.srcSet.attribute),renderTemplate`${maybeRenderHead()}<img${addAttribute(n.src,"src")}${spreadAttributes(s)}${spreadAttributes(n.attributes)}>`}),"/root/code/tmd_astro/node_modules/astro/components/Image.astro",void 0),$$Astro=createAstro("https://tinhmenhdo.com"),$$Picture=createComponent((async(t,e,r)=>{const i=t.createAstro($$Astro,e,r);i.self=$$Picture;const a=["webp"],{formats:n=a,pictureAttributes:s={},fallbackFormat:o,...c}=i.props;if(void 0===c.alt||null===c.alt)throw new AstroError(ImageMissingAlt);const d=c.class?.match(/\bastro-\w{8}\b/)?.[0];d&&(s.class?s.class=`${s.class} ${d}`:s.class=d);for(const t in c)t.startsWith("data-astro-cid")&&(s[t]=c[t]);const g=await resolveSrc(c.src),h=await Promise.all(n.map((async t=>await getImage({...c,src:g,format:t,widths:c.widths,densities:c.densities}))));let l=o??"png";!o&&isESMImportedImage(g)&&["gif","svg","jpg","jpeg"].includes(g.format)&&(l=g.format);const f=await getImage({...c,format:l,widths:c.widths,densities:c.densities}),u={},I={};return c.sizes&&(I.sizes=c.sizes),f.srcSet.values.length>0&&(u.srcset=f.srcSet.attribute),renderTemplate`${maybeRenderHead()}<picture${spreadAttributes(s)}> ${Object.entries(h).map((([t,e])=>{const r=c.densities||!c.densities&&!c.widths?`${e.src}${e.srcSet.values.length>0?", "+e.srcSet.attribute:""}`:e.srcSet.attribute;return renderTemplate`<source${addAttribute(r,"srcset")}${addAttribute(mime.lookup(e.options.format??e.src)??`image/${e.options.format}`,"type")}${spreadAttributes(I)}>`}))} <img${addAttribute(f.src,"src")}${spreadAttributes(u)}${spreadAttributes(f.attributes)}> </picture>`}),"/root/code/tmd_astro/node_modules/astro/components/Picture.astro",void 0),imageConfig={service:{entrypoint:"astro/assets/services/sharp",config:{}},domains:["cdn.pixabay.com"],remotePatterns:[]},getImage=async t=>await getImage$1(t,imageConfig);export{$$Image as $,getImage as g};