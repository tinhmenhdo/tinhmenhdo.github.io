import{g as t}from"./lGe4XDVY.js";import{i as e,j as r,k as o,l as i,m as a,r as n,n as s,o as h,h as d,p as c,d as l,c as g,e as u,f,g as y}from"./CMCES_17.js";var p,m,_,b,x={exports:{}},v={},S={},M={},F={},N={};function w(){if(b)return N;b=1,Object.defineProperty(N,"__esModule",{value:!0}),N.Rect=void 0;const t=e(),n=r(),s=i(),h=a(),d=o();let c=class extends n.Shape{_sceneFunc(t){const e=this.cornerRadius(),r=this.width(),o=this.height();t.beginPath(),e?h.Util.drawRoundedRectPath(t,r,o,e):t.rect(0,0,r,o),t.closePath(),t.fillStrokeShape(this)}};return N.Rect=c,c.prototype.className="Rect",(0,s._registerNode)(c),t.Factory.addGetterSetter(c,"cornerRadius",0,(0,d.getNumberOrArrayOfNumbersValidator)(4)),N}var P,A,T,C,O,R,V,U,W,z,B,j,H,K,Y,X,q,$,J,Q,Z,tt,et,rt,ot,it,at,G={},k={},I={},E={},D={},L={},nt={},st={},ht={},dt={},ct={},lt={},gt={},ut={},ft={},yt={},pt={},mt={},_t={},bt={},xt={},vt={},St={},Mt={},Ft={},Nt={};function wt(){if(at)return v;at=1,Object.defineProperty(v,"__esModule",{value:!0}),v.Konva=void 0;const t=l(),b=g(),x=u(),N=f(),wt=function(){if(p)return S;p=1,Object.defineProperty(S,"__esModule",{value:!0}),S.Ellipse=void 0;const t=e(),a=r(),n=o(),s=i();let h=class extends a.Shape{_sceneFunc(t){const e=this.radiusX(),r=this.radiusY();t.beginPath(),t.save(),e!==r&&t.scale(1,r/e),t.arc(0,0,e,0,2*Math.PI,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.radiusX()}getHeight(){return 2*this.radiusY()}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}};return S.Ellipse=h,h.prototype.className="Ellipse",h.prototype._centroid=!0,h.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,s._registerNode)(h),t.Factory.addComponentsGetterSetter(h,"radius",["x","y"]),t.Factory.addGetterSetter(h,"radiusX",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(h,"radiusY",0,(0,n.getNumberValidator)()),S}(),Pt=function(){if(m)return M;m=1,Object.defineProperty(M,"__esModule",{value:!0}),M.Image=void 0;const t=a(),n=e(),s=r(),h=i(),d=o();let c=class e extends s.Shape{constructor(t){super(t),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",(t=>{this._removeImageLoad(t.oldVal),this._setImageLoad()})),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&4===t.readyState||t&&t.addEventListener&&t.addEventListener("load",this._loadListener)}_removeImageLoad(t){t&&t.removeEventListener&&t.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const t=!!this.cornerRadius(),e=this.hasShadow();return!(!t||!e)||super._useBufferCanvas(!0)}_sceneFunc(e){const r=this.getWidth(),o=this.getHeight(),i=this.cornerRadius(),a=this.attrs.image;let n;if(a){const t=this.attrs.cropWidth,e=this.attrs.cropHeight;n=t&&e?[a,this.cropX(),this.cropY(),t,e,0,0,r,o]:[a,0,0,r,o]}(this.hasFill()||this.hasStroke()||i)&&(e.beginPath(),i?t.Util.drawRoundedRectPath(e,r,o,i):e.rect(0,0,r,o),e.closePath(),e.fillStrokeShape(this)),a&&(i&&e.clip(),e.drawImage.apply(e,n))}_hitFunc(e){const r=this.width(),o=this.height(),i=this.cornerRadius();e.beginPath(),i?t.Util.drawRoundedRectPath(e,r,o,i):e.rect(0,0,r,o),e.closePath(),e.fillStrokeShape(this)}getWidth(){var t,e;return null!==(t=this.attrs.width)&&void 0!==t?t:null===(e=this.image())||void 0===e?void 0:e.width}getHeight(){var t,e;return null!==(t=this.attrs.height)&&void 0!==t?t:null===(e=this.image())||void 0===e?void 0:e.height}static fromURL(r,o,i=null){const a=t.Util.createImageElement();a.onload=function(){const t=new e({image:a});o(t)},a.onerror=i,a.crossOrigin="Anonymous",a.src=r}};return M.Image=c,c.prototype.className="Image",(0,h._registerNode)(c),n.Factory.addGetterSetter(c,"cornerRadius",0,(0,d.getNumberOrArrayOfNumbersValidator)(4)),n.Factory.addGetterSetter(c,"image"),n.Factory.addComponentsGetterSetter(c,"crop",["x","y","width","height"]),n.Factory.addGetterSetter(c,"cropX",0,(0,d.getNumberValidator)()),n.Factory.addGetterSetter(c,"cropY",0,(0,d.getNumberValidator)()),n.Factory.addGetterSetter(c,"cropWidth",0,(0,d.getNumberValidator)()),n.Factory.addGetterSetter(c,"cropHeight",0,(0,d.getNumberValidator)()),M}(),At=function(){if(_)return F;_=1,Object.defineProperty(F,"__esModule",{value:!0}),F.Tag=F.Label=void 0;const t=e(),a=r(),s=n(),h=o(),d=i(),c=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],l="up",g="right",u="down",f="left",p=c.length;let y=class extends s.Group{constructor(t){super(t),this.on("add.konva",(function(t){this._addListeners(t.child),this._sync()}))}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let e,r=this;const o=function(){r._sync()};for(e=0;e<p;e++)t.on(c[e]+"Change.konva",o)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t,e,r,o,i,a,n,s=this.getText(),h=this.getTag();if(s&&h){switch(t=s.width(),e=s.height(),r=h.pointerDirection(),o=h.pointerWidth(),n=h.pointerHeight(),i=0,a=0,r){case l:i=t/2,a=-1*n;break;case g:i=t+o,a=e/2;break;case u:i=t/2,a=e+n;break;case f:i=-1*o,a=e/2}h.setAttrs({x:-1*i,y:-1*a,width:t,height:e}),s.setAttrs({x:-1*i,y:-1*a})}}};F.Label=y,y.prototype.className="Label",(0,d._registerNode)(y);class m extends a.Shape{_sceneFunc(t){const e=this.width(),r=this.height(),o=this.pointerDirection(),i=this.pointerWidth(),a=this.pointerHeight(),n=this.cornerRadius();let s=0,h=0,d=0,c=0;"number"==typeof n?s=h=d=c=Math.min(n,e/2,r/2):(s=Math.min(n[0]||0,e/2,r/2),h=Math.min(n[1]||0,e/2,r/2),c=Math.min(n[2]||0,e/2,r/2),d=Math.min(n[3]||0,e/2,r/2)),t.beginPath(),t.moveTo(s,0),o===l&&(t.lineTo((e-i)/2,0),t.lineTo(e/2,-1*a),t.lineTo((e+i)/2,0)),t.lineTo(e-h,0),t.arc(e-h,h,h,3*Math.PI/2,0,!1),o===g&&(t.lineTo(e,(r-a)/2),t.lineTo(e+i,r/2),t.lineTo(e,(r+a)/2)),t.lineTo(e,r-c),t.arc(e-c,r-c,c,0,Math.PI/2,!1),o===u&&(t.lineTo((e+i)/2,r),t.lineTo(e/2,r+a),t.lineTo((e-i)/2,r)),t.lineTo(d,r),t.arc(d,r-d,d,Math.PI/2,Math.PI,!1),o===f&&(t.lineTo(0,(r+a)/2),t.lineTo(-1*i,r/2),t.lineTo(0,(r-a)/2)),t.lineTo(0,s),t.arc(s,s,s,Math.PI,3*Math.PI/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,e=0,r=this.pointerWidth(),o=this.pointerHeight(),i=this.pointerDirection(),a=this.width(),n=this.height();return i===l?(e-=o,n+=o):i===u?n+=o:i===f?(t-=1.5*r,a+=r):i===g&&(a+=1.5*r),{x:t,y:e,width:a,height:n}}}return F.Tag=m,m.prototype.className="Tag",(0,d._registerNode)(m),t.Factory.addGetterSetter(m,"pointerDirection","none"),t.Factory.addGetterSetter(m,"pointerWidth",0,(0,h.getNumberValidator)()),t.Factory.addGetterSetter(m,"pointerHeight",0,(0,h.getNumberValidator)()),t.Factory.addGetterSetter(m,"cornerRadius",0,(0,h.getNumberOrArrayOfNumbersValidator)(4)),F}(),Ct=y(),Gt=h(),Ot=w(),Tt=function(){if(P)return G;P=1,Object.defineProperty(G,"__esModule",{value:!0}),G.RegularPolygon=void 0;const t=e(),a=r(),n=o(),s=i();let h=class extends a.Shape{_sceneFunc(t){const e=this._getPoints();t.beginPath(),t.moveTo(e[0].x,e[0].y);for(let r=1;r<e.length;r++)t.lineTo(e[r].x,e[r].y);t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,e=this.attrs.radius||0,r=[];for(let o=0;o<t;o++)r.push({x:e*Math.sin(2*o*Math.PI/t),y:-1*e*Math.cos(2*o*Math.PI/t)});return r}getSelfRect(){const t=this._getPoints();let e=t[0].x,r=t[0].y,o=t[0].x,i=t[0].y;return t.forEach((t=>{e=Math.min(e,t.x),r=Math.max(r,t.x),o=Math.min(o,t.y),i=Math.max(i,t.y)})),{x:e,y:o,width:r-e,height:i-o}}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}};return G.RegularPolygon=h,h.prototype.className="RegularPolygon",h.prototype._centroid=!0,h.prototype._attrsAffectingSize=["radius"],(0,s._registerNode)(h),t.Factory.addGetterSetter(h,"radius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(h,"sides",0,(0,n.getNumberValidator)()),G}(),Rt=function(){if(A)return k;A=1,Object.defineProperty(k,"__esModule",{value:!0}),k.Ring=void 0;const t=e(),a=r(),n=o(),s=i(),h=2*Math.PI;let d=class extends a.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,h,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),h,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}};return k.Ring=d,d.prototype.className="Ring",d.prototype._centroid=!0,d.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,s._registerNode)(d),t.Factory.addGetterSetter(d,"innerRadius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(d,"outerRadius",0,(0,n.getNumberValidator)()),k}(),kt=function(){if(T)return I;T=1,Object.defineProperty(I,"__esModule",{value:!0}),I.Sprite=void 0;const t=e(),a=r(),n=s(),h=o(),d=i();let c=class extends a.Shape{constructor(t){super(t),this._updated=!0,this.anim=new n.Animation((()=>{const t=this._updated;return this._updated=!1,t})),this.on("animationChange.konva",(function(){this.frameIndex(0)})),this.on("frameIndexChange.konva",(function(){this._updated=!0})),this.on("frameRateChange.konva",(function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())}))}_sceneFunc(t){const e=this.animation(),r=this.frameIndex(),o=4*r,i=this.animations()[e],a=this.frameOffsets(),n=i[o+0],s=i[o+1],h=i[o+2],d=i[o+3],c=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,h,d),t.closePath(),t.fillStrokeShape(this)),c)if(a){const o=a[e],i=2*r;t.drawImage(c,n,s,h,d,o[i+0],o[i+1],h,d)}else t.drawImage(c,n,s,h,d,0,0,h,d)}_hitFunc(t){const e=this.animation(),r=this.frameIndex(),o=4*r,i=this.animations()[e],a=this.frameOffsets(),n=i[o+2],s=i[o+3];if(t.beginPath(),a){const o=a[e],i=2*r;t.rect(o[i+0],o[i+1],n,s)}else t.rect(0,0,n,s);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const t=this;this.interval=setInterval((function(){t._updateIndex()}),1e3/this.frameRate())}start(){if(this.isRunning())return;const t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const t=this.frameIndex(),e=this.animation();t<this.animations()[e].length/4-1?this.frameIndex(t+1):this.frameIndex(0)}};return I.Sprite=c,c.prototype.className="Sprite",(0,d._registerNode)(c),t.Factory.addGetterSetter(c,"animation"),t.Factory.addGetterSetter(c,"animations"),t.Factory.addGetterSetter(c,"frameOffsets"),t.Factory.addGetterSetter(c,"image"),t.Factory.addGetterSetter(c,"frameIndex",0,(0,h.getNumberValidator)()),t.Factory.addGetterSetter(c,"frameRate",17,(0,h.getNumberValidator)()),t.Factory.backCompat(c,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),I}(),It=function(){if(C)return E;C=1,Object.defineProperty(E,"__esModule",{value:!0}),E.Star=void 0;const t=e(),a=r(),n=o(),s=i();let h=class extends a.Shape{_sceneFunc(t){const e=this.innerRadius(),r=this.outerRadius(),o=this.numPoints();t.beginPath(),t.moveTo(0,0-r);for(let i=1;i<2*o;i++){const a=i%2==0?r:e,n=a*Math.sin(i*Math.PI/o),s=-1*a*Math.cos(i*Math.PI/o);t.lineTo(n,s)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}};return E.Star=h,h.prototype.className="Star",h.prototype._centroid=!0,h.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,s._registerNode)(h),t.Factory.addGetterSetter(h,"numPoints",5,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(h,"innerRadius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(h,"outerRadius",0,(0,n.getNumberValidator)()),E}(),Et=d(),Dt=function(){if(O)return D;O=1,Object.defineProperty(D,"__esModule",{value:!0}),D.TextPath=void 0;const t=a(),n=e(),s=r(),c=h(),l=d(),g=o(),u=i(),f="normal";function p(t){t.fillText(this.partialText,0,0)}function y(t){t.strokeText(this.partialText,0,0)}let m=class extends s.Shape{constructor(e){super(e),this.dummyCanvas=t.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",(function(){this._readDataAttribute(),this._setTextData()})),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return c.Path.getPathLength(this.dataArray)}_getPointAtLength(t){return this.attrs.data?t-1>this.pathLength?null:c.Path.getPointAtLengthOfDataArray(t,this.dataArray):null}_readDataAttribute(){this.dataArray=c.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();const e=this.textDecoration(),r=this.fill(),o=this.fontSize(),i=this.glyphInfo;"underline"===e&&t.beginPath();for(let r=0;r<i.length;r++){t.save();const a=i[r].p0;t.translate(a.x,a.y),t.rotate(i[r].rotation),this.partialText=i[r].text,t.fillStrokeShape(this),"underline"===e&&(0===r&&t.moveTo(0,o/2+1),t.lineTo(o,o/2+1)),t.restore()}"underline"===e&&(t.strokeStyle=r,t.lineWidth=o/20,t.stroke()),t.restore()}_hitFunc(t){t.beginPath();const e=this.glyphInfo;if(e.length>=1){const r=e[0].p0;t.moveTo(r.x,r.y)}for(let r=0;r<e.length;r++){const o=e[r].p1;t.lineTo(o.x,o.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return l.Text.prototype.setText.call(this,t)}_getContextFont(){return l.Text.prototype._getContextFont.call(this)}_getTextSize(t){const e=this.dummyCanvas.getContext("2d");e.save(),e.font=this._getContextFont();const r=e.measureText(t);return e.restore(),{width:r.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:t,height:e}=this._getTextSize(this.attrs.text);if(this.textWidth=t,this.textHeight=e,this.glyphInfo=[],!this.attrs.data)return null;const r=this.letterSpacing(),o=this.align(),i=this.kerningFunc(),a=Math.max(this.textWidth+((this.attrs.text||"").length-1)*r,0);let n=0;"center"===o&&(n=Math.max(0,this.pathLength/2-a/2)),"right"===o&&(n=Math.max(0,this.pathLength-a));const s=(0,l.stringToArray)(this.text());let h=n;for(let t=0;t<s.length;t++){const e=this._getPointAtLength(h);if(!e)return;let n=this._getTextSize(s[t]).width+r;if(" "===s[t]&&"justify"===o){const t=this.text().split(" ").length-1;n+=(this.pathLength-a)/t}const d=this._getPointAtLength(h+n);if(!d)return;const l=c.Path.getLineLength(e.x,e.y,d.x,d.y);let g=0;if(i)try{g=i(s[t-1],s[t])*this.fontSize()}catch(t){g=0}e.x+=g,d.x+=g,this.textWidth+=g;const u=c.Path.getPointOnLine(g+l/2,e.x,e.y,d.x,d.y),f=Math.atan2(d.y-e.y,d.x-e.x);this.glyphInfo.push({transposeX:u.x,transposeY:u.y,text:s[t],rotation:f,p0:e,p1:d}),h+=n}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const t=[];this.glyphInfo.forEach((function(e){t.push(e.p0.x),t.push(e.p0.y),t.push(e.p1.x),t.push(e.p1.y)}));let e,r,o=t[0]||0,i=t[0]||0,a=t[1]||0,n=t[1]||0;for(let s=0;s<t.length/2;s++)e=t[2*s],r=t[2*s+1],o=Math.min(o,e),i=Math.max(i,e),a=Math.min(a,r),n=Math.max(n,r);const s=this.fontSize();return{x:o-s/2,y:a-s/2,width:i-o+s,height:n-a+s}}destroy(){return t.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};return D.TextPath=m,m.prototype._fillFunc=p,m.prototype._strokeFunc=y,m.prototype._fillFuncHit=p,m.prototype._strokeFuncHit=y,m.prototype.className="TextPath",m.prototype._attrsAffectingSize=["text","fontSize","data"],(0,u._registerNode)(m),n.Factory.addGetterSetter(m,"data"),n.Factory.addGetterSetter(m,"fontFamily","Arial"),n.Factory.addGetterSetter(m,"fontSize",12,(0,g.getNumberValidator)()),n.Factory.addGetterSetter(m,"fontStyle",f),n.Factory.addGetterSetter(m,"align","left"),n.Factory.addGetterSetter(m,"letterSpacing",0,(0,g.getNumberValidator)()),n.Factory.addGetterSetter(m,"textBaseline","middle"),n.Factory.addGetterSetter(m,"fontVariant",f),n.Factory.addGetterSetter(m,"text",""),n.Factory.addGetterSetter(m,"textDecoration",""),n.Factory.addGetterSetter(m,"kerningFunc",void 0),D}(),Lt=function(){if(R)return L;R=1,Object.defineProperty(L,"__esModule",{value:!0}),L.Transformer=void 0;const t=a(),s=e(),h=c(),d=r(),l=w(),g=n(),u=i(),f=o(),p=i(),y="tr-konva",m=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map((t=>t+`.${y}`)).join(" "),_="nodesRect",b=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],x={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},v="ontouchstart"in u.Konva._global,S=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function M(t,e,r){const o=r.x+(t.x-r.x)*Math.cos(e)-(t.y-r.y)*Math.sin(e),i=r.y+(t.x-r.x)*Math.sin(e)+(t.y-r.y)*Math.cos(e);return{...t,rotation:t.rotation+e,x:o,y:i}}let F=0,N=class extends g.Group{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(m,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(e){return t.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return y+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();const r=e.filter((e=>!e.isAncestorOf(this)||(t.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1)));return this._nodes=e=r,1===e.length&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach((t=>{const e=()=>{1===this.nodes().length&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),this._transforming||this.isDragging()||this.update()};if(t._attrsAffectingSize.length){const r=t._attrsAffectingSize.map((t=>t+"Change."+this._getEventNamespace())).join(" ");t.on(r,e)}t.on(b.map((t=>t+`.${this._getEventNamespace()}`)).join(" "),e),t.on(`absoluteTransformChange.${this._getEventNamespace()}`,e),this._proxyDrag(t)})),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let e;t.on(`dragstart.${this._getEventNamespace()}`,(r=>{e=t.getAbsolutePosition(),this.isDragging()||t===this.findOne(".back")||this.startDrag(r,!1)})),t.on(`dragmove.${this._getEventNamespace()}`,(r=>{if(!e)return;const o=t.getAbsolutePosition(),i=o.x-e.x,a=o.y-e.y;this.nodes().forEach((e=>{if(e===t)return;if(e.isDragging())return;const o=e.getAbsolutePosition();e.setAbsolutePosition({x:o.x+i,y:o.y+a}),e.startDrag(r)})),e=null}))}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach((t=>{t.off("."+this._getEventNamespace())})),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(_),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(_,this.__getNodeRect)}__getNodeShape(t,e=this.rotation(),r){const o=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),i=t.getAbsoluteScale(r),a=t.getAbsolutePosition(r),n=o.x*i.x-t.offsetX()*i.x,s=o.y*i.y-t.offsetY()*i.y,h=(u.Konva.getAngle(t.getAbsoluteRotation())+2*Math.PI)%(2*Math.PI);return M({x:a.x+n*Math.cos(h)+s*Math.sin(-h),y:a.y+s*Math.cos(h)+n*Math.sin(h),width:o.width*i.x,height:o.height*i.y,rotation:h},-u.Konva.getAngle(e),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const e=[];this.nodes().map((t=>{const r=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),o=[{x:r.x,y:r.y},{x:r.x+r.width,y:r.y},{x:r.x+r.width,y:r.y+r.height},{x:r.x,y:r.y+r.height}],i=t.getAbsoluteTransform();o.forEach((function(t){const r=i.point(t);e.push(r)}))}));const r=new t.Transform;r.rotate(-u.Konva.getAngle(this.rotation()));let o=1/0,i=1/0,a=-1/0,n=-1/0;e.forEach((function(t){const e=r.point(t);void 0===o&&(o=a=e.x,i=n=e.y),o=Math.min(o,e.x),i=Math.min(i,e.y),a=Math.max(a,e.x),n=Math.max(n,e.y)})),r.invert();const s=r.point({x:o,y:i});return{x:s.x,y:s.y,width:a-o,height:n-i,rotation:u.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),S.forEach((t=>{this._createAnchor(t)})),this._createAnchor("rotater")}_createAnchor(e){const r=new l.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:v?10:"auto"}),o=this;r.on("mousedown touchstart",(function(t){o._handleMouseDown(t)})),r.on("dragstart",(t=>{r.stopDrag(),t.cancelBubble=!0})),r.on("dragend",(t=>{t.cancelBubble=!0})),r.on("mouseenter",(()=>{const o=u.Konva.getAngle(this.rotation()),i=this.rotateAnchorCursor(),a=function(e,r,o){if("rotater"===e)return o;r+=t.Util.degToRad(x[e]||0);const i=(t.Util.radToDeg(r)%360+360)%360;return t.Util._inRange(i,337.5,360)||t.Util._inRange(i,0,22.5)?"ns-resize":t.Util._inRange(i,22.5,67.5)?"nesw-resize":t.Util._inRange(i,67.5,112.5)?"ew-resize":t.Util._inRange(i,112.5,157.5)?"nwse-resize":t.Util._inRange(i,157.5,202.5)?"ns-resize":t.Util._inRange(i,202.5,247.5)?"nesw-resize":t.Util._inRange(i,247.5,292.5)?"ew-resize":t.Util._inRange(i,292.5,337.5)?"nwse-resize":(t.Util.error("Transformer has unknown angle for cursor detection: "+i),"pointer")}(e,o,i);r.getStage().content&&(r.getStage().content.style.cursor=a),this._cursorChange=!0})),r.on("mouseout",(()=>{r.getStage().content&&(r.getStage().content.style.cursor=""),this._cursorChange=!1})),this.add(r)}_createBack(){const e=new d.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(e,r){const o=r.getParent(),i=o.padding();e.beginPath(),e.rect(-i,-i,r.width()+2*i,r.height()+2*i),e.moveTo(r.width()/2,-i),o.rotateEnabled()&&o.rotateLineVisible()&&e.lineTo(r.width()/2,-o.rotateAnchorOffset()*t.Util._sign(r.height())-i),e.fillStrokeShape(r)},hitFunc:(t,e)=>{if(!this.shouldOverdrawWholeArea())return;const r=this.padding();t.beginPath(),t.rect(-r,-r,e.width()+2*r,e.height()+2*r),t.fillStrokeShape(e)}});this.add(e),this._proxyDrag(e),e.on("dragstart",(t=>{t.cancelBubble=!0})),e.on("dragmove",(t=>{t.cancelBubble=!0})),e.on("dragend",(t=>{t.cancelBubble=!0})),this.on("dragmove",(t=>{this.update()}))}_handleMouseDown(t){if(this._transforming)return;this._movingAnchorName=t.target.name().split(" ")[0];const e=this._getNodeRect(),r=e.width,o=e.height,i=Math.sqrt(Math.pow(r,2)+Math.pow(o,2));this.sin=Math.abs(o/i),this.cos=Math.abs(r/i),"undefined"!=typeof window&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const a=t.target.getAbsolutePosition(),n=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:n.x-a.x,y:n.y-a.y},F++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach((e=>{e._fire("transformstart",{evt:t.evt,target:e})}))}_handleMouseMove(t){let e,r,o;const i=this.findOne("."+this._movingAnchorName),a=i.getStage();a.setPointersPositions(t);const n=a.getPointerPosition();let s={x:n.x-this._anchorDragOffset.x,y:n.y-this._anchorDragOffset.y};const h=i.getAbsolutePosition();this.anchorDragBoundFunc()&&(s=this.anchorDragBoundFunc()(h,s,t)),i.setAbsolutePosition(s);const d=i.getAbsolutePosition();if(h.x===d.x&&h.y===d.y)return;if("rotater"===this._movingAnchorName){const o=this._getNodeRect();e=i.x()-o.width/2,r=-i.y()+o.height/2;let a=Math.atan2(-r,e)+Math.PI/2;o.height<0&&(a-=Math.PI);const n=u.Konva.getAngle(this.rotation())+a,s=u.Konva.getAngle(this.rotationSnapTolerance()),h=function(t,e,r){let o=e;for(let i=0;i<t.length;i++){const a=u.Konva.getAngle(t[i]),n=Math.abs(a-e)%(2*Math.PI);Math.min(n,2*Math.PI-n)<r&&(o=a)}return o}(this.rotationSnaps(),n,s),d=function(t,e){const r=function(t){return{x:t.x+t.width/2*Math.cos(t.rotation)+t.height/2*Math.sin(-t.rotation),y:t.y+t.height/2*Math.cos(t.rotation)+t.width/2*Math.sin(t.rotation)}}(t);return M(t,e,r)}(o,h-o.rotation);return void this._fitNodesInto(d,t)}const c=this.shiftBehavior();let l;l="inverted"===c?this.keepRatio()&&!t.shiftKey:"none"===c?this.keepRatio():this.keepRatio()||t.shiftKey;var g=this.centeredScaling()||t.altKey;if("top-left"===this._movingAnchorName){if(l){var f=g?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};o=Math.sqrt(Math.pow(f.x-i.x(),2)+Math.pow(f.y-i.y(),2));var p=this.findOne(".top-left").x()>f.x?-1:1,y=this.findOne(".top-left").y()>f.y?-1:1;e=o*this.cos*p,r=o*this.sin*y,this.findOne(".top-left").x(f.x-e),this.findOne(".top-left").y(f.y-r)}}else if("top-center"===this._movingAnchorName)this.findOne(".top-left").y(i.y());else if("top-right"===this._movingAnchorName){l&&(f=g?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()},o=Math.sqrt(Math.pow(i.x()-f.x,2)+Math.pow(f.y-i.y(),2)),p=this.findOne(".top-right").x()<f.x?-1:1,y=this.findOne(".top-right").y()>f.y?-1:1,e=o*this.cos*p,r=o*this.sin*y,this.findOne(".top-right").x(f.x+e),this.findOne(".top-right").y(f.y-r));var m=i.position();this.findOne(".top-left").y(m.y),this.findOne(".bottom-right").x(m.x)}else"middle-left"===this._movingAnchorName?this.findOne(".top-left").x(i.x()):"middle-right"===this._movingAnchorName?this.findOne(".bottom-right").x(i.x()):"bottom-left"===this._movingAnchorName?(l&&(f=g?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()},o=Math.sqrt(Math.pow(f.x-i.x(),2)+Math.pow(i.y()-f.y,2)),p=f.x<i.x()?-1:1,y=i.y()<f.y?-1:1,e=o*this.cos*p,r=o*this.sin*y,i.x(f.x-e),i.y(f.y+r)),m=i.position(),this.findOne(".top-left").x(m.x),this.findOne(".bottom-right").y(m.y)):"bottom-center"===this._movingAnchorName?this.findOne(".bottom-right").y(i.y()):"bottom-right"===this._movingAnchorName&&l&&(f=g?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()},o=Math.sqrt(Math.pow(i.x()-f.x,2)+Math.pow(i.y()-f.y,2)),p=this.findOne(".bottom-right").x()<f.x?-1:1,y=this.findOne(".bottom-right").y()<f.y?-1:1,e=o*this.cos*p,r=o*this.sin*y,this.findOne(".bottom-right").x(f.x+e),this.findOne(".bottom-right").y(f.y+r));if(g=this.centeredScaling()||t.altKey){const t=this.findOne(".top-left"),e=this.findOne(".bottom-right"),r=t.x(),o=t.y(),i=this.getWidth()-e.x(),a=this.getHeight()-e.y();e.move({x:-r,y:-o}),t.move({x:i,y:a})}const _=this.findOne(".top-left").getAbsolutePosition();e=_.x,r=_.y;const b=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),x=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:e,y:r,width:b,height:x,rotation:u.Konva.getAngle(this.rotation())},t)}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var e;if(this._transforming){this._transforming=!1,"undefined"!=typeof window&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const r=this.getNode();F--,this._fire("transformend",{evt:t,target:r}),null===(e=this.getLayer())||void 0===e||e.batchDraw(),r&&this._nodes.forEach((e=>{var r;e._fire("transformend",{evt:t,target:e}),null===(r=e.getLayer())||void 0===r||r.batchDraw()})),this._movingAnchorName=null}}_fitNodesInto(e,r){const o=this._getNodeRect();if(t.Util._inRange(e.width,2*-this.padding()-1,1))return void this.update();if(t.Util._inRange(e.height,2*-this.padding()-1,1))return void this.update();const i=new t.Transform;if(i.rotate(u.Konva.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){const t=i.point({x:2*-this.padding(),y:0});e.x+=t.x,e.y+=t.y,e.width+=2*this.padding(),this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=t.x,this._anchorDragOffset.y-=t.y}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){const t=i.point({x:2*this.padding(),y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=t.x,this._anchorDragOffset.y-=t.y,e.width+=2*this.padding()}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){const t=i.point({x:0,y:2*-this.padding()});e.x+=t.x,e.y+=t.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=t.x,this._anchorDragOffset.y-=t.y,e.height+=2*this.padding()}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const t=i.point({x:0,y:2*this.padding()});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=t.x,this._anchorDragOffset.y-=t.y,e.height+=2*this.padding()}if(this.boundBoxFunc()){const r=this.boundBoxFunc()(o,e);r?e=r:t.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const a=1e7,n=new t.Transform;n.translate(o.x,o.y),n.rotate(o.rotation),n.scale(o.width/a,o.height/a);const s=new t.Transform,h=e.width/a,d=e.height/a;!1===this.flipEnabled()?(s.translate(e.x,e.y),s.rotate(e.rotation),s.translate(e.width<0?e.width:0,e.height<0?e.height:0),s.scale(Math.abs(h),Math.abs(d))):(s.translate(e.x,e.y),s.rotate(e.rotation),s.scale(h,d));const c=s.multiply(n.invert());this._nodes.forEach((e=>{var r;const o=e.getParent().getAbsoluteTransform(),i=e.getTransform().copy();i.translate(e.offsetX(),e.offsetY());const a=new t.Transform;a.multiply(o.copy().invert()).multiply(c).multiply(o).multiply(i);const n=a.decompose();e.setAttrs(n),null===(r=e.getLayer())||void 0===r||r.batchDraw()})),this.rotation(t.Util._getRotation(e.rotation)),this._nodes.forEach((t=>{this._fire("transform",{evt:r,target:t}),t._fire("transform",{evt:r,target:t})})),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,e){this.findOne(t).setAttrs(e)}update(){var e;const r=this._getNodeRect();this.rotation(t.Util._getRotation(r.rotation));const o=r.width,i=r.height,a=this.enabledAnchors(),n=this.resizeEnabled(),s=this.padding(),h=this.anchorSize(),d=this.find("._anchor");d.forEach((t=>{t.setAttrs({width:h,height:h,offsetX:h/2,offsetY:h/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})})),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:h/2+s,offsetY:h/2+s,visible:n&&a.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:o/2,y:0,offsetY:h/2+s,visible:n&&a.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:o,y:0,offsetX:h/2-s,offsetY:h/2+s,visible:n&&a.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:i/2,offsetX:h/2+s,visible:n&&a.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:o,y:i/2,offsetX:h/2-s,visible:n&&a.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:i,offsetX:h/2+s,offsetY:h/2-s,visible:n&&a.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:o/2,y:i,offsetY:h/2-s,visible:n&&a.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:o,y:i,offsetX:h/2-s,offsetY:h/2-s,visible:n&&a.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:o/2,y:-this.rotateAnchorOffset()*t.Util._sign(i)-s,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:o,height:i,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const c=this.anchorStyleFunc();c&&d.forEach((t=>{c(t)})),null===(e=this.getLayer())||void 0===e||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),g.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return h.Node.prototype.toObject.call(this)}clone(t){return h.Node.prototype.clone.call(this,t)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};return L.Transformer=N,N.isTransforming=()=>F>0,N.prototype.className="Transformer",(0,p._registerNode)(N),s.Factory.addGetterSetter(N,"enabledAnchors",S,(function(e){return e instanceof Array||t.Util.warn("enabledAnchors value should be an array"),e instanceof Array&&e.forEach((function(e){-1===S.indexOf(e)&&t.Util.warn("Unknown anchor name: "+e+". Available names are: "+S.join(", "))})),e||[]})),s.Factory.addGetterSetter(N,"flipEnabled",!0,(0,f.getBooleanValidator)()),s.Factory.addGetterSetter(N,"resizeEnabled",!0),s.Factory.addGetterSetter(N,"anchorSize",10,(0,f.getNumberValidator)()),s.Factory.addGetterSetter(N,"rotateEnabled",!0),s.Factory.addGetterSetter(N,"rotateLineVisible",!0),s.Factory.addGetterSetter(N,"rotationSnaps",[]),s.Factory.addGetterSetter(N,"rotateAnchorOffset",50,(0,f.getNumberValidator)()),s.Factory.addGetterSetter(N,"rotateAnchorCursor","crosshair"),s.Factory.addGetterSetter(N,"rotationSnapTolerance",5,(0,f.getNumberValidator)()),s.Factory.addGetterSetter(N,"borderEnabled",!0),s.Factory.addGetterSetter(N,"anchorStroke","rgb(0, 161, 255)"),s.Factory.addGetterSetter(N,"anchorStrokeWidth",1,(0,f.getNumberValidator)()),s.Factory.addGetterSetter(N,"anchorFill","white"),s.Factory.addGetterSetter(N,"anchorCornerRadius",0,(0,f.getNumberValidator)()),s.Factory.addGetterSetter(N,"borderStroke","rgb(0, 161, 255)"),s.Factory.addGetterSetter(N,"borderStrokeWidth",1,(0,f.getNumberValidator)()),s.Factory.addGetterSetter(N,"borderDash"),s.Factory.addGetterSetter(N,"keepRatio",!0),s.Factory.addGetterSetter(N,"shiftBehavior","default"),s.Factory.addGetterSetter(N,"centeredScaling",!1),s.Factory.addGetterSetter(N,"ignoreStroke",!1),s.Factory.addGetterSetter(N,"padding",0,(0,f.getNumberValidator)()),s.Factory.addGetterSetter(N,"nodes"),s.Factory.addGetterSetter(N,"node"),s.Factory.addGetterSetter(N,"boundBoxFunc"),s.Factory.addGetterSetter(N,"anchorDragBoundFunc"),s.Factory.addGetterSetter(N,"anchorStyleFunc"),s.Factory.addGetterSetter(N,"shouldOverdrawWholeArea",!1),s.Factory.addGetterSetter(N,"useSingleNodeRotation",!0),s.Factory.backCompat(N,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),L}(),Vt=function(){if(V)return nt;V=1,Object.defineProperty(nt,"__esModule",{value:!0}),nt.Wedge=void 0;const t=e(),a=r(),n=i(),s=o(),h=i();let d=class extends a.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,n.Konva.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}};return nt.Wedge=d,d.prototype.className="Wedge",d.prototype._centroid=!0,d.prototype._attrsAffectingSize=["radius"],(0,h._registerNode)(d),t.Factory.addGetterSetter(d,"radius",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(d,"angle",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(d,"clockwise",!1),t.Factory.backCompat(d,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),nt}(),Ut=function(){if(U)return st;U=1,Object.defineProperty(st,"__esModule",{value:!0}),st.Blur=void 0;const t=e(),r=c(),i=o();function a(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const n=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],s=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];return st.Blur=function(t){const e=Math.round(this.blurRadius());e>0&&function(t,e){const r=t.data,o=t.width,i=t.height;let h,d,c,l,g,u,f,p,y,m,_,b,x,v,S,M,F,N,w,P,A,C,G,O;const T=e+e+1,R=o-1,k=i-1,I=e+1,E=I*(I+1)/2,D=new a,L=n[e],V=s[e];let U=null,W=D,z=null,B=null;for(c=1;c<T;c++)W=W.next=new a,c===I&&(U=W);for(W.next=D,f=u=0,d=0;d<i;d++){for(M=F=N=w=p=y=m=_=0,b=I*(P=r[u]),x=I*(A=r[u+1]),v=I*(C=r[u+2]),S=I*(G=r[u+3]),p+=E*P,y+=E*A,m+=E*C,_+=E*G,W=D,c=0;c<I;c++)W.r=P,W.g=A,W.b=C,W.a=G,W=W.next;for(c=1;c<I;c++)l=u+((R<c?R:c)<<2),p+=(W.r=P=r[l])*(O=I-c),y+=(W.g=A=r[l+1])*O,m+=(W.b=C=r[l+2])*O,_+=(W.a=G=r[l+3])*O,M+=P,F+=A,N+=C,w+=G,W=W.next;for(z=D,B=U,h=0;h<o;h++)r[u+3]=G=_*L>>V,0!==G?(G=255/G,r[u]=(p*L>>V)*G,r[u+1]=(y*L>>V)*G,r[u+2]=(m*L>>V)*G):r[u]=r[u+1]=r[u+2]=0,p-=b,y-=x,m-=v,_-=S,b-=z.r,x-=z.g,v-=z.b,S-=z.a,l=f+((l=h+e+1)<R?l:R)<<2,M+=z.r=r[l],F+=z.g=r[l+1],N+=z.b=r[l+2],w+=z.a=r[l+3],p+=M,y+=F,m+=N,_+=w,z=z.next,b+=P=B.r,x+=A=B.g,v+=C=B.b,S+=G=B.a,M-=P,F-=A,N-=C,w-=G,B=B.next,u+=4;f+=o}for(h=0;h<o;h++){for(F=N=w=M=y=m=_=p=0,u=h<<2,b=I*(P=r[u]),x=I*(A=r[u+1]),v=I*(C=r[u+2]),S=I*(G=r[u+3]),p+=E*P,y+=E*A,m+=E*C,_+=E*G,W=D,c=0;c<I;c++)W.r=P,W.g=A,W.b=C,W.a=G,W=W.next;for(g=o,c=1;c<=e;c++)u=g+h<<2,p+=(W.r=P=r[u])*(O=I-c),y+=(W.g=A=r[u+1])*O,m+=(W.b=C=r[u+2])*O,_+=(W.a=G=r[u+3])*O,M+=P,F+=A,N+=C,w+=G,W=W.next,c<k&&(g+=o);for(u=h,z=D,B=U,d=0;d<i;d++)l=u<<2,r[l+3]=G=_*L>>V,G>0?(G=255/G,r[l]=(p*L>>V)*G,r[l+1]=(y*L>>V)*G,r[l+2]=(m*L>>V)*G):r[l]=r[l+1]=r[l+2]=0,p-=b,y-=x,m-=v,_-=S,b-=z.r,x-=z.g,v-=z.b,S-=z.a,l=h+((l=d+I)<k?l:k)*o<<2,p+=M+=z.r=r[l],y+=F+=z.g=r[l+1],m+=N+=z.b=r[l+2],_+=w+=z.a=r[l+3],z=z.next,b+=P=B.r,x+=A=B.g,v+=C=B.b,S+=G=B.a,M-=P,F-=A,N-=C,w-=G,B=B.next,u+=o}}(t,e)},t.Factory.addGetterSetter(r.Node,"blurRadius",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),st}(),Wt=function(){if(W)return ht;W=1,Object.defineProperty(ht,"__esModule",{value:!0}),ht.Brighten=void 0;const t=e(),r=c(),i=o();return ht.Brighten=function(t){const e=255*this.brightness(),r=t.data,o=r.length;for(let t=0;t<o;t+=4)r[t]+=e,r[t+1]+=e,r[t+2]+=e},t.Factory.addGetterSetter(r.Node,"brightness",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),ht}(),zt=function(){if(z)return dt;z=1,Object.defineProperty(dt,"__esModule",{value:!0}),dt.Contrast=void 0;const t=e(),r=c(),i=o();return dt.Contrast=function(t){const e=Math.pow((this.contrast()+100)/100,2),r=t.data,o=r.length;let i=150,a=150,n=150;for(let t=0;t<o;t+=4)i=r[t],a=r[t+1],n=r[t+2],i/=255,i-=.5,i*=e,i+=.5,i*=255,a/=255,a-=.5,a*=e,a+=.5,a*=255,n/=255,n-=.5,n*=e,n+=.5,n*=255,i=i<0?0:i>255?255:i,a=a<0?0:a>255?255:a,n=n<0?0:n>255?255:n,r[t]=i,r[t+1]=a,r[t+2]=n},t.Factory.addGetterSetter(r.Node,"contrast",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),dt}(),Bt=function(){if(B)return ct;B=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.Emboss=void 0;const t=e(),r=c(),i=a(),n=o();return ct.Emboss=function(t){const e=10*this.embossStrength(),r=255*this.embossWhiteLevel(),o=this.embossDirection(),a=this.embossBlend(),n=t.data,s=t.width,h=t.height,d=4*s;let c=0,l=0,g=h;switch(o){case"top-left":c=-1,l=-1;break;case"top":c=-1,l=0;break;case"top-right":c=-1,l=1;break;case"right":c=0,l=1;break;case"bottom-right":c=1,l=1;break;case"bottom":c=1,l=0;break;case"bottom-left":c=1,l=-1;break;case"left":c=0,l=-1;break;default:i.Util.error("Unknown emboss direction: "+o)}do{const t=(g-1)*d;let o=c;g+o<1&&(o=0),g+o>h&&(o=0);const i=(g-1+o)*s*4;let u=s;do{const o=t+4*(u-1);let h=l;u+h<1&&(h=0),u+h>s&&(h=0);const d=i+4*(u-1+h),c=n[o]-n[d],g=n[o+1]-n[d+1],f=n[o+2]-n[d+2];let p=c;const y=p>0?p:-p;if((g>0?g:-g)>y&&(p=g),(f>0?f:-f)>y&&(p=f),p*=e,a){const t=n[o]+p,e=n[o+1]+p,r=n[o+2]+p;n[o]=t>255?255:t<0?0:t,n[o+1]=e>255?255:e<0?0:e,n[o+2]=r>255?255:r<0?0:r}else{let t=r-p;t<0?t=0:t>255&&(t=255),n[o]=n[o+1]=n[o+2]=t}}while(--u)}while(--g)},t.Factory.addGetterSetter(r.Node,"embossStrength",.5,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(r.Node,"embossWhiteLevel",.5,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(r.Node,"embossDirection","top-left",void 0,t.Factory.afterSetFilter),t.Factory.addGetterSetter(r.Node,"embossBlend",!1,void 0,t.Factory.afterSetFilter),ct}(),jt=function(){if(j)return lt;j=1,Object.defineProperty(lt,"__esModule",{value:!0}),lt.Enhance=void 0;const t=e(),r=c(),i=o();function a(t,e,r,o,i){const a=r-e,n=i-o;if(0===a)return o+n/2;if(0===n)return o;let s=(t-e)/a;return s=n*s+o,s}return lt.Enhance=function(t){const e=t.data,r=e.length;let o,i,n,s=e[0],h=s,d=e[1],c=d,l=e[2],g=l;const u=this.enhance();if(0===u)return;for(let t=0;t<r;t+=4)o=e[t+0],o<s?s=o:o>h&&(h=o),i=e[t+1],i<d?d=i:i>c&&(c=i),n=e[t+2],n<l?l=n:n>g&&(g=n);let f,p,y,m,_,b,x,v,S;h===s&&(h=255,s=0),c===d&&(c=255,d=0),g===l&&(g=255,l=0),u>0?(p=h+u*(255-h),y=s-u*(s-0),_=c+u*(255-c),b=d-u*(d-0),v=g+u*(255-g),S=l-u*(l-0)):(f=.5*(h+s),p=h+u*(h-f),y=s+u*(s-f),m=.5*(c+d),_=c+u*(c-m),b=d+u*(d-m),x=.5*(g+l),v=g+u*(g-x),S=l+u*(l-x));for(let t=0;t<r;t+=4)e[t+0]=a(e[t+0],s,h,y,p),e[t+1]=a(e[t+1],d,c,b,_),e[t+2]=a(e[t+2],l,g,S,v)},t.Factory.addGetterSetter(r.Node,"enhance",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),lt}(),Ht=(H||(H=1,Object.defineProperty(gt,"__esModule",{value:!0}),gt.Grayscale=void 0,gt.Grayscale=function(t){const e=t.data,r=e.length;for(let t=0;t<r;t+=4){const r=.34*e[t]+.5*e[t+1]+.16*e[t+2];e[t]=r,e[t+1]=r,e[t+2]=r}}),gt),Kt=function(){if(K)return ut;K=1,Object.defineProperty(ut,"__esModule",{value:!0}),ut.HSL=void 0;const t=e(),r=c(),i=o();return t.Factory.addGetterSetter(r.Node,"hue",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(r.Node,"saturation",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(r.Node,"luminance",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),ut.HSL=function(t){const e=t.data,r=e.length,o=Math.pow(2,this.saturation()),i=Math.abs(this.hue()+360)%360,a=127*this.luminance(),n=1*o*Math.cos(i*Math.PI/180),s=1*o*Math.sin(i*Math.PI/180),h=.299+.701*n+.167*s,d=.587-.587*n+.33*s,c=.114-.114*n-.497*s,l=.299-.299*n-.328*s,g=.587+.413*n+.035*s,u=.114-.114*n+.293*s,f=.299-.3*n+1.25*s,p=.587-.586*n-1.05*s,y=.114+.886*n-.2*s;let m,_,b,x;for(let t=0;t<r;t+=4)m=e[t+0],_=e[t+1],b=e[t+2],x=e[t+3],e[t+0]=h*m+d*_+c*b+a,e[t+1]=l*m+g*_+u*b+a,e[t+2]=f*m+p*_+y*b+a,e[t+3]=x},ut}(),Yt=function(){if(Y)return ft;Y=1,Object.defineProperty(ft,"__esModule",{value:!0}),ft.HSV=void 0;const t=e(),r=c(),i=o();return ft.HSV=function(t){const e=t.data,r=e.length,o=Math.pow(2,this.value()),i=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,n=o*i*Math.cos(a*Math.PI/180),s=o*i*Math.sin(a*Math.PI/180),h=.299*o+.701*n+.167*s,d=.587*o-.587*n+.33*s,c=.114*o-.114*n-.497*s,l=.299*o-.299*n-.328*s,g=.587*o+.413*n+.035*s,u=.114*o-.114*n+.293*s,f=.299*o-.3*n+1.25*s,p=.587*o-.586*n-1.05*s,y=.114*o+.886*n-.2*s;let m,_,b,x;for(let t=0;t<r;t+=4)m=e[t+0],_=e[t+1],b=e[t+2],x=e[t+3],e[t+0]=h*m+d*_+c*b,e[t+1]=l*m+g*_+u*b,e[t+2]=f*m+p*_+y*b,e[t+3]=x},t.Factory.addGetterSetter(r.Node,"hue",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(r.Node,"saturation",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(r.Node,"value",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),ft}(),Xt=(X||(X=1,Object.defineProperty(yt,"__esModule",{value:!0}),yt.Invert=void 0,yt.Invert=function(t){const e=t.data,r=e.length;for(let t=0;t<r;t+=4)e[t]=255-e[t],e[t+1]=255-e[t+1],e[t+2]=255-e[t+2]}),yt),qt=function(){if(q)return pt;q=1,Object.defineProperty(pt,"__esModule",{value:!0}),pt.Kaleidoscope=void 0;const t=e(),r=c(),i=a(),n=o();return pt.Kaleidoscope=function(t){const e=t.width,r=t.height;let o,a,n,s,h,d,c,l,g,u,f=Math.round(this.kaleidoscopePower());const p=Math.round(this.kaleidoscopeAngle()),y=Math.floor(e*(p%360)/360);if(f<1)return;const m=i.Util.createCanvasElement();m.width=e,m.height=r;const _=m.getContext("2d").getImageData(0,0,e,r);i.Util.releaseCanvas(m),function(t,e,r){const o=t.data,i=e.data,a=t.width,n=t.height,s=r.polarCenterX||a/2,h=r.polarCenterY||n/2;let d=Math.sqrt(s*s+h*h),c=a-s,l=n-h;const g=Math.sqrt(c*c+l*l);d=g>d?g:d;const u=n,f=a,p=360/f*Math.PI/180;for(let t=0;t<f;t+=1){const e=Math.sin(t*p),r=Math.cos(t*p);for(let n=0;n<u;n+=1){c=Math.floor(s+d*n/u*r),l=Math.floor(h+d*n/u*e);let g=4*(l*a+c);const f=o[g+0],p=o[g+1],y=o[g+2],m=o[g+3];g=4*(t+n*a),i[g+0]=f,i[g+1]=p,i[g+2]=y,i[g+3]=m}}}(t,_,{polarCenterX:e/2,polarCenterY:r/2});let b=e/Math.pow(2,f);for(;b<=8;)b*=2,f-=1;b=Math.ceil(b);let x=b,v=0,S=x,M=1;for(y+b>e&&(v=x,S=0,M=-1),a=0;a<r;a+=1)for(o=v;o!==S;o+=M)n=Math.round(o+y)%e,g=4*(e*a+n),h=_.data[g+0],d=_.data[g+1],c=_.data[g+2],l=_.data[g+3],u=4*(e*a+o),_.data[u+0]=h,_.data[u+1]=d,_.data[u+2]=c,_.data[u+3]=l;for(a=0;a<r;a+=1)for(x=Math.floor(b),s=0;s<f;s+=1){for(o=0;o<x+1;o+=1)g=4*(e*a+o),h=_.data[g+0],d=_.data[g+1],c=_.data[g+2],l=_.data[g+3],u=4*(e*a+2*x-o-1),_.data[u+0]=h,_.data[u+1]=d,_.data[u+2]=c,_.data[u+3]=l;x*=2}!function(t,e,r){const o=t.data,i=e.data,a=t.width,n=t.height,s=r.polarCenterX||a/2,h=r.polarCenterY||n/2;let d=Math.sqrt(s*s+h*h),c=a-s,l=n-h;const g=Math.sqrt(c*c+l*l);d=g>d?g:d;const u=n,f=a;let p,y;for(c=0;c<a;c+=1)for(l=0;l<n;l+=1){const t=c-s,e=l-h,r=Math.sqrt(t*t+e*e)*u/d;let n=(180*Math.atan2(e,t)/Math.PI+360+0)%360;n=n*f/360,p=Math.floor(n),y=Math.floor(r);let g=4*(y*a+p);const m=o[g+0],_=o[g+1],b=o[g+2],x=o[g+3];g=4*(l*a+c),i[g+0]=m,i[g+1]=_,i[g+2]=b,i[g+3]=x}}(_,t,{})},t.Factory.addGetterSetter(r.Node,"kaleidoscopePower",2,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(r.Node,"kaleidoscopeAngle",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),pt}(),$t=function(){if($)return mt;$=1,Object.defineProperty(mt,"__esModule",{value:!0}),mt.Mask=void 0;const t=e(),r=c(),i=o();function a(t,e,r){let o=4*(r*t.width+e);const i=[];return i.push(t.data[o++],t.data[o++],t.data[o++],t.data[o++]),i}function n(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}return mt.Mask=function(t){let e=function(t,e){const r=a(t,0,0),o=a(t,t.width-1,0),i=a(t,0,t.height-1),s=a(t,t.width-1,t.height-1),h=e||10;if(n(r,o)<h&&n(o,s)<h&&n(s,i)<h&&n(i,r)<h){const e=function(t){const e=[0,0,0];for(let r=0;r<t.length;r++)e[0]+=t[r][0],e[1]+=t[r][1],e[2]+=t[r][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}([o,r,s,i]),a=[];for(let r=0;r<t.width*t.height;r++){const o=n(e,[t.data[4*r],t.data[4*r+1],t.data[4*r+2]]);a[r]=o<h?0:255}return a}}(t,this.threshold());return e&&(e=function(t,e,r){const o=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(o.length)),a=Math.floor(i/2),n=[];for(let s=0;s<r;s++)for(let h=0;h<e;h++){const d=s*e+h;let c=0;for(let n=0;n<i;n++)for(let d=0;d<i;d++){const l=s+n-a,g=h+d-a;if(l>=0&&l<r&&g>=0&&g<e){const r=o[n*i+d];c+=t[l*e+g]*r}}n[d]=2040===c?255:0}return n}(e,t.width,t.height),e=function(t,e,r){const o=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(o.length)),a=Math.floor(i/2),n=[];for(let s=0;s<r;s++)for(let h=0;h<e;h++){const d=s*e+h;let c=0;for(let n=0;n<i;n++)for(let d=0;d<i;d++){const l=s+n-a,g=h+d-a;if(l>=0&&l<r&&g>=0&&g<e){const r=o[n*i+d];c+=t[l*e+g]*r}}n[d]=c>=1020?255:0}return n}(e,t.width,t.height),e=function(t,e,r){const o=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9],i=Math.round(Math.sqrt(o.length)),a=Math.floor(i/2),n=[];for(let s=0;s<r;s++)for(let h=0;h<e;h++){const d=s*e+h;let c=0;for(let n=0;n<i;n++)for(let d=0;d<i;d++){const l=s+n-a,g=h+d-a;if(l>=0&&l<r&&g>=0&&g<e){const r=o[n*i+d];c+=t[l*e+g]*r}}n[d]=c}return n}(e,t.width,t.height),function(t,e){for(let r=0;r<t.width*t.height;r++)t.data[4*r+3]=e[r]}(t,e)),t},t.Factory.addGetterSetter(r.Node,"threshold",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),mt}(),Jt=function(){if(J)return _t;J=1,Object.defineProperty(_t,"__esModule",{value:!0}),_t.Noise=void 0;const t=e(),r=c(),i=o();return _t.Noise=function(t){const e=255*this.noise(),r=t.data,o=r.length,i=e/2;for(let t=0;t<o;t+=4)r[t+0]+=i-2*i*Math.random(),r[t+1]+=i-2*i*Math.random(),r[t+2]+=i-2*i*Math.random()},t.Factory.addGetterSetter(r.Node,"noise",.2,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),_t}(),Qt=function(){if(Q)return bt;Q=1,Object.defineProperty(bt,"__esModule",{value:!0}),bt.Pixelate=void 0;const t=e(),r=a(),i=c(),n=o();return bt.Pixelate=function(t){let e,o,i,a,n,s,h,d,c,l,g,u,f,p,y=Math.ceil(this.pixelSize()),m=t.width,_=t.height,b=Math.ceil(m/y),x=Math.ceil(_/y),v=t.data;if(y<=0)r.Util.error("pixelSize value can not be <= 0");else for(u=0;u<b;u+=1)for(f=0;f<x;f+=1){for(a=0,n=0,s=0,h=0,d=u*y,c=d+y,l=f*y,g=l+y,p=0,e=d;e<c;e+=1)if(!(e>=m))for(o=l;o<g;o+=1)o>=_||(i=4*(m*o+e),a+=v[i+0],n+=v[i+1],s+=v[i+2],h+=v[i+3],p+=1);for(a/=p,n/=p,s/=p,h/=p,e=d;e<c;e+=1)if(!(e>=m))for(o=l;o<g;o+=1)o>=_||(i=4*(m*o+e),v[i+0]=a,v[i+1]=n,v[i+2]=s,v[i+3]=h)}},t.Factory.addGetterSetter(i.Node,"pixelSize",8,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),bt}(),Zt=function(){if(Z)return xt;Z=1,Object.defineProperty(xt,"__esModule",{value:!0}),xt.Posterize=void 0;const t=e(),r=c(),i=o();return xt.Posterize=function(t){const e=Math.round(254*this.levels())+1,r=t.data,o=r.length,i=255/e;for(let t=0;t<o;t+=1)r[t]=Math.floor(r[t]/i)*i},t.Factory.addGetterSetter(r.Node,"levels",.5,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),xt}(),te=function(){if(tt)return vt;tt=1,Object.defineProperty(vt,"__esModule",{value:!0}),vt.RGB=void 0;const t=e(),r=c(),i=o();return vt.RGB=function(t){const e=t.data,r=e.length,o=this.red(),i=this.green(),a=this.blue();for(let t=0;t<r;t+=4){const r=(.34*e[t]+.5*e[t+1]+.16*e[t+2])/255;e[t]=r*o,e[t+1]=r*i,e[t+2]=r*a,e[t+3]=e[t+3]}},t.Factory.addGetterSetter(r.Node,"red",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),t.Factory.addGetterSetter(r.Node,"green",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),t.Factory.addGetterSetter(r.Node,"blue",0,i.RGBComponent,t.Factory.afterSetFilter),vt}(),ee=function(){if(et)return St;et=1,Object.defineProperty(St,"__esModule",{value:!0}),St.RGBA=void 0;const t=e(),r=c(),i=o();return St.RGBA=function(t){const e=t.data,r=e.length,o=this.red(),i=this.green(),a=this.blue(),n=this.alpha();for(let t=0;t<r;t+=4){const r=1-n;e[t]=o*n+e[t]*r,e[t+1]=i*n+e[t+1]*r,e[t+2]=a*n+e[t+2]*r}},t.Factory.addGetterSetter(r.Node,"red",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),t.Factory.addGetterSetter(r.Node,"green",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),t.Factory.addGetterSetter(r.Node,"blue",0,i.RGBComponent,t.Factory.afterSetFilter),t.Factory.addGetterSetter(r.Node,"alpha",1,(function(t){return this._filterUpToDate=!1,t>1?1:t<0?0:t})),St}(),re=(rt||(rt=1,Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.Sepia=void 0,Mt.Sepia=function(t){const e=t.data,r=e.length;for(let t=0;t<r;t+=4){const r=e[t+0],o=e[t+1],i=e[t+2];e[t+0]=Math.min(255,.393*r+.769*o+.189*i),e[t+1]=Math.min(255,.349*r+.686*o+.168*i),e[t+2]=Math.min(255,.272*r+.534*o+.131*i)}}),Mt),oe=(ot||(ot=1,Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.Solarize=void 0,Ft.Solarize=function(t){const e=t.data,r=t.width,o=4*r;let i=t.height;do{const t=(i-1)*o;let a=r;do{const r=t+4*(a-1);let o=e[r],i=e[r+1],n=e[r+2];o>127&&(o=255-o),i>127&&(i=255-i),n>127&&(n=255-n),e[r]=o,e[r+1]=i,e[r+2]=n}while(--a)}while(--i)}),Ft),ie=function(){if(it)return Nt;it=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.Threshold=void 0;const t=e(),r=c(),i=o();return Nt.Threshold=function(t){const e=255*this.threshold(),r=t.data,o=r.length;for(let t=0;t<o;t+=1)r[t]=r[t]<e?0:255},t.Factory.addGetterSetter(r.Node,"threshold",.5,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),Nt}();return v.Konva=t.Konva.Util._assign(t.Konva,{Arc:b.Arc,Arrow:x.Arrow,Circle:N.Circle,Ellipse:wt.Ellipse,Image:Pt.Image,Label:At.Label,Tag:At.Tag,Line:Ct.Line,Path:Gt.Path,Rect:Ot.Rect,RegularPolygon:Tt.RegularPolygon,Ring:Rt.Ring,Sprite:kt.Sprite,Star:It.Star,Text:Et.Text,TextPath:Dt.TextPath,Transformer:Lt.Transformer,Wedge:Vt.Wedge,Filters:{Blur:Ut.Blur,Brighten:Wt.Brighten,Contrast:zt.Contrast,Emboss:Bt.Emboss,Enhance:jt.Enhance,Grayscale:Ht.Grayscale,HSL:Kt.HSL,HSV:Yt.HSV,Invert:Xt.Invert,Kaleidoscope:qt.Kaleidoscope,Mask:$t.Mask,Noise:Jt.Noise,Pixelate:Qt.Pixelate,Posterize:Zt.Posterize,RGB:te.RGB,RGBA:ee.RGBA,Sepia:re.Sepia,Solarize:oe.Solarize,Threshold:ie.Threshold}}),v}var Pt,At=x.exports;const Tt=t(function(){if(Pt)return x.exports;Pt=1,Object.defineProperty(At,"__esModule",{value:!0});const t=wt();return x.exports=t.Konva,x.exports}());export{Tt as K,w as r};