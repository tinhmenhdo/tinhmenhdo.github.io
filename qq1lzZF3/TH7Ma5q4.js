import{j as e}from"./C2QZIOQO.js";import{r as l}from"./mSt8MfY5.js";import{C as _,a as N,b as H,c as b,L as C,d as S,e as v}from"./VsI6Tx2J.js";import{c as I}from"./CZdqJKJf.js";import"./Cpj98o6Y.js";const D=["https://worldtimeapi.org/api/timezone/Asia/Ho_Chi_Minh","https://api.weatherapi.com/v1/timezone.json?key=0155aa8ee0e3416ab5851326241611&q=Ho_Chi_Minh","https://timeapi.io/api/Time/current/zone?timeZone=Asia/Ho_Chi_Minh","https://www.timeapi.io/api/Time/current/zone?timeZone=Asia/Ho_Chi_Minh","https://www.timeapi.dev/api/Time/current/zone?timeZone=Asia/Ho_Chi_Minh","https://api.sunrise-sunset.org/json?lat=10.8231&lng=106.6297&formatted=0",{url:"https://time.vuquyettam.workers.dev",noCors:!0}],M=(s,n)=>{try{return n.includes("weatherapi")?new Date(s.location.localtime):n.includes("worldtimeapi")?new Date(s.datetime):n.includes("timeapi.io")||n.includes("timeapi.dev")?new Date(s.dateTime):n.includes("sunrise-sunset")?new Date(s.results.solar_noon):n.includes("vuquyettam")?new Date(s.timestamp):null}catch{return null}},f=l.memo(({label:s,time:n,minute:c,lunarTime:d,can:m,chi:u,lthg:h})=>e.jsxs("div",{className:"py-5 bg-black/55 rounded-xl font-heading",children:[e.jsx("div",{className:"font-bold uppercase text-white/40",children:s}),e.jsx("time",{className:"font-bold text-orange-200 text-[1.15em] max-md:text-[1.2em]",children:s==="Giờ"?`${String(n).padStart(2,"0")}h${String(c).padStart(2,"0")}`:`${String(n).padStart(2,"0")}`}),e.jsx("div",{className:"font-bold uppercase",children:d?e.jsx("span",{className:"px-3 text-gray-500 bg-white/80 rounded-2xl",children:String(d).padStart(2,"0")}):e.jsx("span",{className:"text-gray-500",children:" "})}),e.jsx("div",{className:`font-bold uppercase color${_[m]}`,children:N[m]}),e.jsx("div",{className:`font-bold uppercase color${H[u]}`,children:b[u]}),e.jsx("div",{className:`text-[0.6em] font-sans color${C[h]}`,children:S[h]})]})),k=()=>{const[s,n]=l.useState(new Date),[c,d]=l.useState(0),[m,u]=l.useState(!1),[h,T]=l.useState(!0),w=async()=>{const j=new Promise((i,o)=>setTimeout(()=>o(new Error("Timeout")),3e3)),x=D.map(i=>{const o=typeof i=="string"?i:i.url,p={headers:{},signal:AbortSignal.timeout(3e3)};return typeof i!="string"&&i.noCors&&(p.mode="no-cors"),fetch(o,p).then(async a=>{if(!a.ok&&a.type!=="opaque")throw new Error("Not OK");return a.type==="opaque"?{timestamp:Date.now()}:a.json()}).then(a=>({data:a,url:o})).catch(()=>null)});try{const i=await Promise.race([Promise.race(x.filter(Boolean)),j]);if(!i)return!1;const{data:o,url:p}=i,a=M(o,p);if(!a||isNaN(a.getTime()))return!1;const y=new Date,g=a.getTime()-y.getTime();return console.log("offset",g,a,y),Math.abs(g)>24*60*60*1e3?!1:(d(g),n(a),!0)}catch{return!1}};l.useEffect(()=>{(async()=>{m||(await w(),u(!0),T(!1))})();const x=setInterval(()=>{const o=new Date(Date.now()+c);n(o)},1e3),i=setInterval(w,36e5);return()=>{clearInterval(x),clearInterval(i)}},[c,m]);const r=I(s.getFullYear(),s.getMonth()+1,s.getDate(),s.getHours(),s.getMinutes());console.log("lunaBorn",r.sun.year(),r.sun.month(),r.sun.day(),r.sun.hour(),r.sun.minute());const t=v(r);return e.jsx("div",{className:"w-full",children:h?e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-current border-r-transparent align-[-0.125em] motion-reduce:animate-[spin_1.5s_linear_infinite]"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-center mb-7",children:e.jsxs("h2",{className:"text-[20px] mb-3 max-sm:mb-2",children:["Lịch âm hôm nay là",e.jsxs("strong",{className:"mx-1 font-bold text-orange-300 max-md:block",children:["ngày ",r.d," tháng ",r.m]}),"năm",e.jsxs("span",{className:"mx-1 font-bold darkColor",children:[e.jsx("span",{className:"font-bold uppercase",children:N[t.bs.y[0]]})," ",e.jsx("span",{className:"font-bold uppercase",children:b[t.bs.y[1]]})]}),"hiện tại là giờ ",e.jsx("strong",{className:"font-bold uppercase",children:b[t.bs.h[1]]})]})}),e.jsxs("div",{className:"grid grid-cols-4 text-center w-[800px] max-md:w-full mx-auto gap-3 text-[2.5em] max-md:text-[1.3em] font-mono darkColor",children:[e.jsx(f,{label:"Năm",time:t.sn.y,can:t.bs.y[0],chi:t.bs.y[1],lthg:t.bs.y[2]}),e.jsx(f,{label:"Tháng",time:t.sn.m,lunarTime:t.ln.m,can:t.bs.m[0],chi:t.bs.m[1],lthg:t.bs.m[2]}),e.jsx(f,{label:"Ngày",time:t.sn.d,lunarTime:t.ln.d,can:t.bs.d[0],chi:t.bs.d[1],lthg:t.bs.d[2]}),e.jsx(f,{label:"Giờ",time:t.sn.h,minute:s.getMinutes(),lunarTime:t.ln.h,can:t.bs.h[0],chi:t.bs.h[1],lthg:t.bs.h[2]})]})]})})},q=l.memo(k);export{q as default};
